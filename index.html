<!DOCTYPE html>
<html>
<head>
  <title>Tesla I-80 Supercharger Map (Modern Sidebar)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      overflow: hidden;
      background: #e9ecef;
    }
    #sidebar {
      width: 280px;
      background: #f8f9fa;
      box-shadow: 2px 0 5px rgba(0,0,0,0.1);
      padding: 24px 20px 20px 20px;
      display: flex;
      flex-direction: column;
      gap: 24px;
      z-index: 2;
      min-width: 220px;
    }
    #map {
      flex-grow: 1;
      height: 100vh;
      min-width: 0;
    }
    h2 {
      margin-top: 0;
      font-weight: 700;
      color: #333;
      letter-spacing: 0.5px;
      font-size: 1.3em;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #555;
      cursor: pointer;
    }
    select, input[type="checkbox"] {
      margin-right: 10px;
      accent-color: #007bff;
    }
    .restaurant-filters {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .restaurant-filters label {
      font-weight: 500;
      color: #444;
      margin-bottom: 0;
      display: flex;
      align-items: center;
    }
    .footer {
      margin-top: auto;
      font-size: 0.95em;
      color: #888;
      text-align: center;
      padding-top: 20px;
      border-top: 1px solid #e0e0e0;
    }
    @media (max-width: 700px) {
      #sidebar { width: 100vw; min-width: 0; box-shadow: none; }
      body, html { flex-direction: column; }
      #map { height: 60vh; }
    }
  </style>
</head>
<body>
  <div id="sidebar">
    <h2>Filter Options</h2>
    <div>
      <label for="direction">Travel Direction</label>
      <select id="direction">
        <option value="eastbound">Eastbound (Oakland → Truckee)</option>
        <option value="westbound">Westbound (Truckee → Oakland)</option>
      </select>
    </div>
    <div class="restaurant-filters">
      <label><input type="checkbox" class="restaurant-type" value="chipotle" checked> Chipotle</label>
      <label><input type="checkbox" class="restaurant-type" value="panera" checked> Panera</label>
      <label><input type="checkbox" class="restaurant-type" value="chickfila" checked> Chick-fil-A</label>
      <label><input type="checkbox" class="restaurant-type" value="habit" checked> Habit Burger</label>
      <label><input type="checkbox" class="restaurant-type" value="panda" checked> Panda Express</label>
    </div>
    <div class="footer">Tesla I-80 Supercharger Map</div>
  </div>
  <div id="map"></div>

  <script>
    // Supercharger and Restaurant Data (expand as needed)
    // direction: 'eastbound', 'westbound', or 'both'
    const superchargers = [
      {
        name: "Oakland - Hegenberger Rd",
        pos: {lat: 37.7698, lng: -122.2758},
        direction: "both",
        restaurants: []
      },
      {
        name: "Alameda South Shore Center",
        pos: {lat: 37.7648, lng: -122.2546},
        direction: "both",
        restaurants: [
          {name: "Chipotle", type: "chipotle", pos: {lat: 37.7655, lng: -122.2541}},
          {name: "Panera", type: "panera", pos: {lat: 37.7650, lng: -122.2550}},
          {name: "Panda Express", type: "panda", pos: {lat: 37.7640, lng: -122.2540}}
        ]
      },
      {
        name: "Vacaville - Nut Tree Rd",
        pos: {lat: 38.3677, lng: -121.9582},
        direction: "eastbound",
        restaurants: [
          {name: "Chipotle", type: "chipotle", pos: {lat: 38.3680, lng: -121.9560}},
          {name: "Panera", type: "panera", pos: {lat: 38.3685, lng: -121.9570}},
          {name: "Panda Express", type: "panda", pos: {lat: 38.3690, lng: -121.9580}}
        ]
      },
      {
        name: "Fairfield - Travis Blvd",
        pos: {lat: 38.2574, lng: -122.0654},
        direction: "westbound",
        restaurants: [
          {name: "Chick-fil-A", type: "chickfila", pos: {lat: 38.2580, lng: -122.0660}},
          {name: "Panda Express", type: "panda", pos: {lat: 38.2578, lng: -122.0650}}
        ]
      },
      {
        name: "Loomis - Raley's",
        pos: {lat: 38.8170, lng: -121.1917},
        direction: "eastbound",
        restaurants: [
          {name: "Starbucks", type: "panera", pos: {lat: 38.8175, lng: -121.1910}}
        ]
      },
      {
        name: "Rocklin Supercharger",
        pos: {lat: 38.7906, lng: -121.2358},
        direction: "both",
        restaurants: [
          {name: "Habit Burger", type: "habit", pos: {lat: 38.7910, lng: -121.2365}},
          {name: "Panda Express", type: "panda", pos: {lat: 38.7915, lng: -121.2370}}
        ]
      },
      {
        name: "Auburn Supercharger",
        pos: {lat: 38.9140, lng: -121.0773},
        direction: "westbound",
        restaurants: [
          {name: "Chick-fil-A", type: "chickfila", pos: {lat: 38.9145, lng: -121.0780}},
          {name: "Panda Express", type: "panda", pos: {lat: 38.9150, lng: -121.0790}}
        ]
      },
      {
        name: "Truckee - Donner Pass Rd",
        pos: {lat: 39.3274, lng: -120.2074},
        direction: "both",
        restaurants: [
          {name: "Panda Express", type: "panda", pos: {lat: 39.3280, lng: -120.2080}}
        ]
      }
    ];

    const icons = {
      chipotle: "http://maps.google.com/mapfiles/ms/icons/brown-dot.png",
      panera: "http://maps.google.com/mapfiles/ms/icons/green-dot.png",
      chickfila: "http://maps.google.com/mapfiles/ms/icons/red-dot.png",
      habit: "http://maps.google.com/mapfiles/ms/icons/blue-dot.png",
      panda: "http://maps.google.com/mapfiles/ms/icons/orange-dot.png",
      supercharger: "http://maps.google.com/mapfiles/ms/icons/yellow-dot.png"
    };

    let map, directionsService, directionsRenderer;
    let chargerMarkers = [];
    let restaurantMarkers = [];

    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        zoom: 8,
        center: {lat: 38.58, lng: -121.49}
      });
      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer({map: map, suppressMarkers: true});
      document.getElementById('direction').addEventListener('change', updateMap);
      document.querySelectorAll('.restaurant-type').forEach(cb => cb.addEventListener('change', updateMap));
      updateMap();
    }

    function updateMap() {
      // Clear old markers
      chargerMarkers.forEach(m => m.setMap(null));
      restaurantMarkers.forEach(m => m.setMap(null));
      chargerMarkers = [];
      restaurantMarkers = [];

      // Get selected direction and restaurant types
      const dir = document.getElementById('direction').value;
      const checkedTypes = Array.from(document.querySelectorAll('.restaurant-type:checked')).map(cb => cb.value);

      // Filter superchargers by direction
      const scs = superchargers.filter(sc => sc.direction === dir || sc.direction === "both");

      // Build route waypoints
      const route = scs.map(sc => sc.pos);

      // Show route if 2+ stops
      if (route.length >= 2) {
        directionsService.route({
          origin: route[0],
          destination: route[route.length - 1],
          waypoints: route.slice(1, -1).map(loc => ({location: loc, stopover: true})),
          travelMode: google.maps.TravelMode.DRIVING
        }, (response, status) => {
          if (status === 'OK') {
            directionsRenderer.setDirections(response);
          }
        });
      }

      // Add Supercharger and restaurant markers
      scs.forEach(sc => {
        // Supercharger marker
        const chargerMarker = new google.maps.Marker({
          position: sc.pos,
          map: map,
          icon: icons.supercharger,
          title: sc.name
        });
        const scInfo = `<b>${sc.name}</b><br>${sc.restaurants.length} restaurants nearby.`;
        chargerMarker.addListener('click', () => {
          new google.maps.InfoWindow({content: scInfo}).open(map, chargerMarker);
        });
        chargerMarkers.push(chargerMarker);

        // Restaurant markers (filtered)
        sc.restaurants.filter(r => checkedTypes.includes(r.type)).forEach(r => {
          const rMarker = new google.maps.Marker({
            position: r.pos,
            map: map,
            icon: icons[r.type],
            title: `${r.name} (near ${sc.name})`
          });
          const rInfo = `<b>${r.name}</b><br>Near: ${sc.name}`;
          rMarker.addListener('click', () => {
            new google.maps.InfoWindow({content: rInfo}).open(map, rMarker);
          });
          restaurantMarkers.push(rMarker);
        });
      });
    }
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCGcxvnuW6VAAtihWg93u0EN3PvZdSAJoM&callback=initMap"
    async defer></script>
</body>
</html>
