<!DOCTYPE html>
<html>
<head>
  <title>Tesla I-80 Supercharger Map with Direction Toggle</title>
  <style>
    #map { height: 90vh; width: 100%; }
    #controls { padding: 10px; background: #fff; box-shadow: 0 2px 6px rgba(0,0,0,0.3); }
    label { font-weight: 500; margin-right: 10px; }
    select { padding: 5px; border-radius: 4px; }
  </style>
</head>
<body>
  <div id="controls">
    <label for="direction">Travel Direction:</label>
    <select id="direction">
      <option value="eastbound">Eastbound (Oakland → Truckee)</option>
      <option value="westbound">Westbound (Truckee → Oakland)</option>
    </select>
  </div>
  <div id="map"></div>

  <script>
    const superchargers = [
      // Oakland Area
      {
        name: "Oakland - Hegenberger Rd",
        pos: {lat: 37.7698, lng: -122.2758},
        restaurants: []
      },
      // Vacaville Area
      {
        name: "Vacaville - Nut Tree Rd",
        pos: {lat: 38.3677, lng: -121.9582},
        restaurants: [
          {name: "Chipotle", type: "chipotle", pos: {lat: 38.3680, lng: -121.9560}},
          {name: "Panera", type: "panera", pos: {lat: 38.3685, lng: -121.9570}},
          {name: "Panda Express", type: "panda", pos: {lat: 38.3690, lng: -121.9580}}
        ]
      },
      // Truckee Area
      {
        name: "Truckee - Donner Pass Rd",
        pos: {lat: 39.3274, lng: -120.2074},
        restaurants: [
          {name: "Panda Express", type: "panda", pos: {lat: 39.3280, lng: -120.2080}}
        ]
      }
    ];

    const icons = {
      chipotle: "http://maps.google.com/mapfiles/ms/icons/brown-dot.png",
      panera: "http://maps.google.com/mapfiles/ms/icons/green-dot.png",
      panda: "http://maps.google.com/mapfiles/ms/icons/orange-dot.png",
      supercharger: "http://maps.google.com/mapfiles/ms/icons/red-dot.png"
    };

    let map, directionsService, directionsRenderer;
    let eastMarkers = [];
    let westMarkers = [];

    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: {lat: 38.58, lng: -121.49},
        zoom: 9
      });

      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer({
        map: map,
        suppressMarkers: true
      });

      document.getElementById('direction').addEventListener('change', updateMap);
      createMarkerLayers();
      updateMap();
    }

    function createMarkerLayers() {
      // Eastbound markers
      superchargers.forEach(sc => {
        eastMarkers.push(createSuperchargerMarker(sc));
        sc.restaurants.forEach(r => eastMarkers.push(createRestaurantMarker(r)));
      });

      // Westbound markers (reverse order)
      [...superchargers].reverse().forEach(sc => {
        westMarkers.push(createSuperchargerMarker(sc));
        sc.restaurants.forEach(r => westMarkers.push(createRestaurantMarker(r)));
